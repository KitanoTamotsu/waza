#urawaza.alfredworkflowのメモ

aa

##機能：
  ランダムに裏技を表示させる

##インストール：
  1.[alfredworkflow](裏技.alfredworkflow)をダウンロード
  2.ファイルをダブルクリックしてワークフローに登録

##使い方：
  Alfredバーでwazaと入力


##背景：
　webサーフィン中にいろいろなターミナルに関する裏技を見ていたのですが、
　たまたま生活の裏技に飛び火して、alfred化してみました

　
##開発メモ：

1.裏技サイトを探す

　経験上ですが、alfred化する場合、検索サイトのラッパーとして使うか、まとまっているサイトからパースするかになる気がします
　https://creive.me/archives/154/　というまとめサイトを見つけたのでパースことにしました
　でも裏技が50個とちょっと少なめです。。

　このサイトの裏技は<li>タグでまとまっています。
　<li>のあとに数字とピリオドがあって、1から50までの裏技が紹介されています
　たまに<b>タグで強調しているので、これを除けばOKそうです

　ここまであたりをつけたらコーディングしましょう
  

2.コーディングする
　
　お約束通りcurlでソースを取得
　改行やスペース、<b>タグ、</b>タグを取り除いて、<li>タグの集合を作ります
　その後で<li>タグ、</li>タグ、先頭の番号を削除
　裏技のなかみ（文字列）を配列liに格納します
　
　サイト上、裏技は50件で変わらなそうな感じではありますが。
　一応、配列liの件数（最大値）を求めて、その中からランダムで3件選択します
　全体が50件なので3件にしてみたという程度です

　後はJSONフォーマットを作成して、はい、できあがり


##最後に：

　テストをしてみて、裏技がalfred出力に全て書かれてしまうので、ちょっと工夫してみました
　それは、先頭の語句だけ出力するというものです
　下記のパターンにマッチした部分だけをtitleとして表示させています
　『〜、』『〜：』『〜に』『〜を』『〜は』『〜の』
　argには裏技の文言全体をセットしていますので
　alfred出力を選択すると、裏技の文言全体でサーチします

